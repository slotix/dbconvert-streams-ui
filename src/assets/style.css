@import 'tailwindcss';
@config "../../tailwind.config.mjs";
@plugin '@tailwindcss/forms';

@theme {
  --font-sans: 'Inter', system-ui, sans-serif;
  --font-heading: 'Plus Jakarta Sans', system-ui, sans-serif;
  --font-mono:
    'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono',
    'Courier New', monospace;
  --font-ui: 'DM Sans', system-ui, sans-serif;

  /* Preserve legacy color aliases */
  --color-gray-50: oklch(98.5% 0 0);
  --color-gray-100: oklch(97% 0 0);
  --color-gray-200: oklch(92.2% 0 0);
  --color-gray-300: oklch(87% 0 0);
  --color-gray-400: oklch(70.8% 0 0);
  --color-gray-500: oklch(55.6% 0 0);
  --color-gray-600: oklch(43.9% 0 0);
  --color-gray-700: oklch(37.1% 0 0);
  --color-gray-800: oklch(26.9% 0 0);
  --color-gray-850: oklch(22% 0 0);
  --color-gray-900: oklch(20.5% 0 0);
  --color-gray-950: oklch(14.5% 0 0);

  --color-yellow-50: oklch(98% 0.016 73.684);
  --color-yellow-100: oklch(95.4% 0.038 75.164);
  --color-yellow-200: oklch(90.1% 0.076 70.697);
  --color-yellow-300: oklch(83.7% 0.128 66.29);
  --color-yellow-400: oklch(75% 0.183 55.934);
  --color-yellow-500: oklch(70.5% 0.213 47.604);
  --color-yellow-600: oklch(64.6% 0.222 41.116);
  --color-yellow-700: oklch(55.3% 0.195 38.402);
  --color-yellow-800: oklch(47% 0.157 37.304);
  --color-yellow-900: oklch(40.8% 0.123 38.172);
  --color-yellow-950: oklch(26.6% 0.079 36.259);

  --color-green-50: oklch(98.4% 0.019 200.873);
  --color-green-100: oklch(95.6% 0.045 203.388);
  --color-green-200: oklch(91.7% 0.08 205.041);
  --color-green-300: oklch(86.5% 0.127 207.078);
  --color-green-400: oklch(78.9% 0.154 211.53);
  --color-green-500: oklch(71.5% 0.143 215.221);
  --color-green-600: oklch(60.9% 0.126 221.723);
  --color-green-700: oklch(52% 0.105 223.128);
  --color-green-800: oklch(45% 0.085 224.283);
  --color-green-900: oklch(39.8% 0.07 227.392);
  --color-green-950: oklch(30.2% 0.056 229.695);
}

@layer base {
  :root {
    color-scheme: light;
    --app-zoom: 1;
  }

  .dark {
    color-scheme: dark;
  }

  /* Fix for Wails/WebKitGTK viewport sizing issues on Linux
     See: https://github.com/wailsapp/wails/issues/2431 */
  html,
  body {
    width: 100%;
    min-width: 100%;
    max-width: 100vw;
    min-height: 100vh;
    margin: 0;
    padding: 0;
  }

  html {
    font-family: 'Inter', system-ui, sans-serif;
    overflow-x: hidden;
  }

  body {
    overflow-x: hidden;
  }

  #app {
    width: 100%;
    min-height: 100vh;
  }

  /* Desktop zoom scaling using CSS zoom property
     Applied via --app-zoom CSS variable set by desktopZoom.ts
     CSS zoom renders text sharply unlike transform:scale(). */
  html.desktop-zoom {
    zoom: var(--app-zoom, 1);
  }

  /* CodeMirror zoom compensation:
     avoid WebKit coordinate/selection glitches under CSS zoom by excluding editor container. */
  html.desktop-zoom .codemirror-editor-container {
    zoom: calc(1 / var(--app-zoom, 1));
    --sql-editor-font-scale: var(--app-zoom, 1);
  }

  /* Improve SVG icon rendering at non-100% zoom levels in WebKitGTK. */
  html.desktop-zoom svg {
    shape-rendering: geometricPrecision;
    stroke-rendering: geometricPrecision;
  }

  /* Keep Lucide stroke width consistent in desktop mode. */
  html.desktop-mode svg.lucide {
    stroke-width: 1;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: 'Plus Jakarta Sans', system-ui, sans-serif;
  }

  code,
  pre,
  kbd,
  samp {
    font-family: 'JetBrains Mono', monospace;
  }

  .ui-elements {
    font-family: 'DM Sans', system-ui, sans-serif;
  }

  /* Disable all element transitions during view transition to prevent tearing */
  html.view-transition-active,
  html.view-transition-active *,
  html.view-transition-active *::before,
  html.view-transition-active *::after {
    transition: none !important;
    transition-duration: 0s !important;
    transition-delay: 0s !important;
    animation-duration: 0s !important;
    animation-delay: 0s !important;
  }

  /* View Transitions API - circular reveal effect (like Radix UI) */
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation: none;
    mix-blend-mode: normal;
  }

  /* Old view stays in place */
  ::view-transition-old(root) {
    z-index: 1;
  }

  /* New view slides in from left to right */
  ::view-transition-new(root) {
    z-index: 9999;
    animation: theme-slide-in 700ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  @keyframes theme-slide-in {
    from {
      clip-path: inset(0 100% 0 0);
    }
    to {
      clip-path: inset(0 0 0 0);
    }
  }

  /* Disable motion for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    ::view-transition-old(root),
    ::view-transition-new(root) {
      animation: none;
    }
  }

  /* Checkbox styling - needs !important to override @tailwindcss/forms */
  input[type='checkbox']:checked {
    background-color: rgb(75 85 99) !important; /* gray-600 */
    border-color: rgb(75 85 99) !important;
  }

  input[type='checkbox']:checked:hover {
    background-color: rgb(55 65 81) !important; /* gray-700 */
    border-color: rgb(55 65 81) !important;
  }

  input[type='checkbox']:indeterminate {
    background-color: rgb(75 85 99) !important; /* gray-600 */
    border-color: rgb(75 85 99) !important;
  }

  .dark input[type='checkbox']:checked {
    background-color: rgb(107 114 128) !important; /* gray-500 */
    border-color: rgb(107 114 128) !important;
  }

  .dark input[type='checkbox']:checked:hover {
    background-color: rgb(156 163 175) !important; /* gray-400 */
    border-color: rgb(156 163 175) !important;
  }

  .dark input[type='checkbox']:indeterminate {
    background-color: rgb(107 114 128) !important; /* gray-500 */
    border-color: rgb(107 114 128) !important;
  }
}

/* ===========================
   Toast Notifications Dark Mode
   =========================== */

.dark .Vue-Toastification__toast {
  background-color: rgb(31 41 55 / 1) !important; /* gray-800 */
  color: rgb(243 244 246 / 1) !important; /* gray-100 */
  border: 1px solid rgb(55 65 81 / 1) !important; /* gray-700 */
  box-shadow:
    0 10px 15px -3px rgb(0 0 0 / 0.3),
    0 4px 6px -4px rgb(0 0 0 / 0.2) !important;
}

.dark .Vue-Toastification__toast--success {
  background-color: rgb(6 78 59 / 1) !important; /* green-900 */
  border-color: rgb(5 150 105 / 1) !important; /* green-600 */
}

.dark .Vue-Toastification__toast--success .Vue-Toastification__icon {
  color: rgb(134 239 172 / 1) !important; /* green-300 */
}

.dark .Vue-Toastification__toast--error {
  background-color: rgb(127 29 29 / 1) !important; /* red-900 */
  border-color: rgb(220 38 38 / 1) !important; /* red-600 */
}

.dark .Vue-Toastification__toast--error .Vue-Toastification__icon {
  color: rgb(252 165 165 / 1) !important; /* red-300 */
}

.dark .Vue-Toastification__toast--warning {
  background-color: rgb(120 53 15 / 1) !important; /* amber-900 */
  border-color: rgb(217 119 6 / 1) !important; /* amber-600 */
}

.dark .Vue-Toastification__toast--warning .Vue-Toastification__icon {
  color: rgb(252 211 77 / 1) !important; /* amber-300 */
}

.dark .Vue-Toastification__toast--info {
  background-color: rgb(30 58 138 / 1) !important; /* blue-900 */
  border-color: rgb(37 99 235 / 1) !important; /* blue-600 */
}

.dark .Vue-Toastification__toast--info .Vue-Toastification__icon {
  color: rgb(147 197 253 / 1) !important; /* blue-300 */
}

.dark .Vue-Toastification__close-button {
  color: rgb(156 163 175 / 1) !important; /* gray-400 */
  opacity: 0.7;
}

.dark .Vue-Toastification__close-button:hover {
  color: rgb(243 244 246 / 1) !important; /* gray-100 */
  opacity: 1;
}

.dark .Vue-Toastification__progress-bar {
  background-color: rgba(255, 255, 255, 0.2) !important;
}

/* ===========================
   CodeMirror Lint Tooltip (Dark)
   =========================== */

.dark .cm-tooltip-lint,
.sql-cm-dark .cm-tooltip-lint {
  background: var(--color-gray-850) !important;
  color: var(--color-gray-100) !important;
  border: 1px solid var(--color-gray-700) !important;
}

.dark .cm-tooltip-lint .cm-diagnostic,
.sql-cm-dark .cm-tooltip-lint .cm-diagnostic {
  background: transparent !important;
  color: var(--color-gray-100) !important;
}

.dark .cm-tooltip-lint .cm-diagnosticText,
.sql-cm-dark .cm-tooltip-lint .cm-diagnosticText {
  color: var(--color-gray-100) !important;
  opacity: 1 !important;
}

.dark .cm-tooltip-lint .cm-diagnosticSource,
.sql-cm-dark .cm-tooltip-lint .cm-diagnosticSource {
  color: var(--color-gray-400) !important;
  opacity: 1 !important;
}
